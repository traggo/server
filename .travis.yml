language: go
go:
  - "1.12"

notifications:
  email: false

env:
  global:
    - UPX_VERSION="3.95"
    - GO111MODULE=on

before_install:
  - mkdir -p ~/bin/ && export PATH="~/bin/:$PATH"
  - curl -fSL https://github.com/upx/upx/releases/download/v${UPX_VERSION}/upx-${UPX_VERSION}-amd64_linux.tar.xz -o ~/upx.tar.xz && tar -xf ~/upx.tar.xz -C ~ && mv ~/upx-${UPX_VERSION}-amd64_linux/upx ~/bin
  - nvm install 11.11.0
  - make download-tools

install:
  - make install

script:
  - make generate
  - make lint
  - make test
  - make build-bin

after_success:
  - bash <(curl -s https://codecov.io/bash)
